(TO DO)remove thread sleeps
